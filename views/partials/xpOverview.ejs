<section class="grid md:grid-cols-3 gap-6 items-stretch">

  <!-- XP Balance Card -->
  <div class="relative md:col-span-2 overflow-hidden
           rounded-3xl p-6 sm:p-8
           bg-gradient-to-br from-[#1e6cff]/30 via-[#3aa7ff]/20 to-[#6a5cff]/30
           border border-white/20 backdrop-blur-xl
           shadow-[0_20px_60px_rgba(0,0,0,0.45)]">

    <!-- Glow -->
    <div class="absolute -top-24 -right-24 w-72 h-72 bg-blue-400/30 blur-3xl rounded-full"></div>

    <div class="relative z-10">
      <p class="text-sm tracking-wide uppercase opacity-80">
        Total XP Balance
      </p>

      <div class="flex flex-col sm:flex-row sm:items-end gap-2 sm:gap-4 mt-4">

        <!-- XP Amount -->
        <div class="flex items-baseline gap-2">
          <h1 class="text-5xl sm:text-6xl md:text-7xl font-extrabold leading-none tracking-tight">
            <span id="xpAmount">
              <%= user.xpBalance ? user.xpBalance.toFixed(2) : '0.00' %>
            </span>
          </h1>

          <span class="text-lg sm:text-xl font-semibold opacity-70">
            XP
          </span>
        </div>

        <!-- USD Value -->
        <span id="usdAmount" class="text-base sm:text-lg font-bold text-[#67f0ff] sm:mb-1">
          ‚âà $<%= user.usdBalance ? user.usdBalance.toFixed(2) : '0.00' %>
        </span>

      </div>


      <!-- Progress -->
      <div class="mt-6">
        <div class="flex justify-between text-xs opacity-70 mb-1">
          <span>Max withdrawal</span>
          <span>$<%= (user.usdBalance || 0).toFixed(2) %> / $5,000</span>
        </div>

        <div class="h-3 rounded-full bg-white/20 overflow-hidden">
          <div id="withdrawalProgress"
            class="h-full bg-gradient-to-r from-[#2da8ff] to-[#6af5ff] transition-all duration-1000 ease-out"
            style="--progress: <%= Math.min(((user.usdBalance || 0) / 5000) * 100, 100) %>%;">
            ></div>

        </div>
      </div>





      <!-- CTA -->
      <div class="flex flex-col sm:flex-row gap-4 mt-6">
        <button id="dailyXpClaim" class="inline-flex items-center justify-center gap-2
                 px-6 py-3 rounded-xl
                 bg-gradient-to-r from-yellow-400/30 to-yellow-500/30
                 border border-yellow-400/40
                 text-yellow-300 font-bold text-sm
                 shadow-[0_0_25px_rgba(255,200,0,0.3)]
                 hover:scale-[1.03] active:scale-95 transition
                 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none" onclick="claimDailyXP()">
          üéÅ Claim +1000 XP
        </button>

        <button id="cashoutBtn" class="inline-flex items-center justify-center gap-2
                 px-6 py-3 rounded-xl
                 bg-gradient-to-r from-green-500/30 to-emerald-500/30
                 border border-emerald-400/40
                 text-emerald-200 font-bold text-sm
                 shadow-[0_0_25px_rgba(16,185,129,0.3)]
                 hover:scale-[1.03] active:scale-95 transition
                 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"
                 onclick="handleCashout()">
          üí∞ Cashout
        </button>
      </div>

      <script>
        function handleCashout() {
          const usdBalance = parseFloat('<%= user.usdBalance || 0 %>');
          const MIN_CASHOUT = 5000;
          
          if (usdBalance >= MIN_CASHOUT) {
            // Show the cashout modal
            document.getElementById('cashoutModal').classList.remove('hidden');
            document.body.classList.add('overflow-hidden');
          } else {
            // Show error toast
            window.toast.error('Insufficient Balance', {
              description: `You need at least $${MIN_CASHOUT.toLocaleString()} USD to cash out.`,
              duration: 5000,
              position: 'top-center',
              style: {
                background: '#1f2937',
                color: '#fff',
                border: '1px solid #374151',
                borderRadius: '0.5rem',
                padding: '0.75rem 1rem',
                boxShadow: '0 4px 12px rgba(0, 0, 0, 0.15)',
              },
            });
          }
        }
      </script>
    </div>
  </div>



  <!-- Level Card -->
  <div class="relative overflow-hidden
           rounded-3xl p-6
           bg-gradient-to-br from-[#2a2a5e]/60 to-[#1b1b3f]/60
           border border-white/20 backdrop-blur-xl
           shadow-[0_20px_60px_rgba(0,0,0,0.45)]
           flex flex-col justify-between">

    <!-- Glow -->
    <div class="absolute -bottom-24 -left-24 w-72 h-72 bg-orange-400/20 blur-3xl rounded-full"></div>

    <div class="relative z-10 text-center">
      <div class="text-4xl mb-2">ü•â</div>

      <p class="font-bold text-lg">Level 1</p>
      <p class="text-sm text-orange-300 tracking-wide uppercase">
        Bronze
      </p>
    </div>

    <div class="relative z-10 mt-6">
      <div class="flex justify-between text-xs opacity-70 mb-1">
        <span>XP Needed</span>
        <span>1000 XP</span>
      </div>

      <div class="h-3 rounded-full bg-white/20 overflow-hidden">
        <div class="h-full w-[20%] bg-gradient-to-r from-orange-400 to-yellow-300"></div>
      </div>
    </div>
  </div>

</section>